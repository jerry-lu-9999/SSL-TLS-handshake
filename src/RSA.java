import java.io.*;
import java.math.BigInteger;
import java.net.InetAddress;
import java.net.Socket;
import java.net.UnknownHostException;

public class RSA {

    static String netID = "jlu39";
    static String NONCE = "30615724";

    static String serverPublicKeyN = "504651504192750178628851763828859154365141322326230869295755735851072159532948722562593727327203221210833527560148723960705255040560185478339691482873981761050037217439208461874901652335441816470824259174320874362222198082222592397646831973539551328755981323139548045072321381475846983310080032507026842453661417385758081556365652204132321895170766657417634168188841188887989068258475000669478008732849946186216749774543865645640196287338709282536710698318412624804325860590715542620541031600810634646539818344592195879057383481071600294096902635442494577855091948313266284854560727883408827991902524279927791554435162246182142596312561468813108465602709057681426275832033148227669576949292235385229230527556635910241686874237920722371055944622202278018369076059026286639296752644989154040560411249439205290407499443936238380381321887001263330236871457894543735357041171566562459719944876123136359463308643205422771343885445840124403553268015397865614548254302714402270538368286891822220812905074348523790634673440021275497924359640079900704677501522617021705410600858295227149764597756540007462246866142712886805086519902002080605450697412966796476227126830973869162255458240361848302670519454600483781331206541005905843335305410003";
    static String serverPublicKeyE = "1378444934640581778273945772374211167397739218517041402155878840645913827255039066138145602342794862329619029210141583631049024731755952582768944984404823590624919870681664244747698289804520273691763348800345248051300550862529558479266885917978436862328948563337047046204585402562331150302956725792258438255446100492987788026896160014555346391887761499360423231638253435157949460254137693445541071931964254673918715539802088639108376461915157103649377145528809012882815140412912785839410167947060079246668623968132114630616581096968401360559869965907123128670499677485764962770307984456914304233181047973535719801429220698794909103488035979863832558704323166871179339260999275999162827024687358012031661749413665456487147358299347366553412074455255913616466045556998557711805529182739598470341865605189931456337787221434121661439027698514045005763727728051402951478199736658573254135533289795655094087984784786520349180975369825013891418608723047304839712400136823033695783168857451720963695702310318664455369072189097155332846188852445717292008480554711474890221363987540110019966692428783122980420731158236893296924009314353563086128918098250282375322087068395073226794895559001784049295630906522121157234537714799886362690410383";
    String clientPrivateD = "13305181995638525843314666615277278847334156220932137411327362508274213816985706021798514894399840934179752679748639201516067491376722954916602531862990421034813251927710607802059441315175834556055588237662475218622460953278914325019450352457411228830907762574300094563977518918324394307162168548015668768534414074918366299337636673593804891067768963184061456181080783721528808028730976397940905616093439638757444969215855529861125606818569466452161617898717290607129668289174679334694670979758727357031320993640033308771161913133402724996823320890648945587468899352823100555111254935902480704749022022726110876128317";
    static Socket socket     = null;

    public static BigInteger convert(String str){
        byte[] arr = str.getBytes();
        return new BigInteger(arr);
    }
    public static String encrypt(String message, String keyN, String keyE){
        BigInteger m = convert(message);
        BigInteger n = convert(keyN);
        BigInteger e = convert(keyE);
        BigInteger result = m.modPow(e, n);
        return String.valueOf(result);
    }

    public static String decrypt(String message, String keyN, String keyD){
        BigInteger m = convert(message);
        BigInteger n = convert(keyN);
        BigInteger d = convert(keyD);
        BigInteger result = m.modPow(d, n);
        return String.valueOf(result);
    }

    public static void main(String[] args) throws IOException {
        try{
            socket = new Socket("cycle3.csug.rochester.edu",2457);
        }catch(UnknownHostException e){
            System.out.println("Get LocalHost failed");
        }
        OutputStream output = socket.getOutputStream();
        InputStream input = socket.getInputStream();

        PrintWriter writer = new PrintWriter(output, true);
        BufferedReader reader = new BufferedReader(new InputStreamReader(input));

        //SECRETSYN: "hello NETID NONCE"
        String secretSYN = "hello " + netID + " " + NONCE;
        writer.println(encrypt(secretSYN, serverPublicKeyN, serverPublicKeyE));

        //SECRETSYNACK
        String receivedM = reader.readLine();

    }
}
